<!DOCTYPE html>
<html>
	<head>
		<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
		<title>Ruby on Rails 实战圣经 | Rails 程式最佳实务</title>
		<link rel="stylesheet" type="text/css" href="./style.css">
		<link rel="canonical" href="https://ihower.tw/rails4/rails-best-practices.html">
	</head>
<body>
<div class="container">
    <div class="page_header">
        <h1 class="logo"><a href="./index.html">Ruby on Rails 实战圣经<span>使用 Rails 4.2 及 Ruby 2.1</span></a></h1>
        <div class="search_box">
            <form class="search" action="https://www.google.com/search">
            <input type="hidden" value="ihower.tw/rails4" name="as_sitesearch">
            <input class="search_field" type="text" value="" name="as_q">
            <input class="search_btn" type="submit" value="Search">
            </form>
        </div>
    </div>

    <div class="notice">
    <p class="inner info_bubble">
      <a href="https://leanpub.com/ihower-rails-book">电子书</a>和简体版本准备中。如果您有任何意见、鼓励或勘误，欢迎<a href="mailto:ihower@gmail.com">来信给我</a>，谢谢。
    </p>
    </div>

    <div class="inner wrap">
       <div class="sidebar">
            <h3><a href="about.html">关于本书</a></h3>
            <h3><a href="index.html">回首页</a></h3>
            <p>本书的原作者是ihower，原为繁体版本，详见<a href="https://ihower.tw/rails4/index.html">这里</a>。我只是改成了简体。谢谢ihower的努力，写出了这么优秀的教程！</p>
       </div>
       <div class="content body">
	      <h1 id="rails-">Rails 程式最佳实务</h1>

<blockquote>
  <p>Good code is its own best documentation. As you’re about to add a comment, ask yourself, ‘How can I improve the code so that this comment isn’t needed?’ Improve the code and then document it to make it even clearer. – Steve McConnell, Code Complete 作者</p>
</blockquote>

<p>到目前为止我们主要学习如何让程式完成我们想要的功能，而真正专业的程式设计师精益求精，思考如何让程式写的漂亮、容易维护，打造高品质的<a href="http://manifesto.softwarecraftsmanship.org/">软件工艺</a>。这一章我们来讨论这个主题。当然，在修改重构程式前，最好拥有自动化测试，以确保程式于修改后执行无误。</p>

<h2 id="section">基本观念</h2>

<p>随著日渐复杂的程式和多人团队开发的演进，你的程式会变得：</p>

<ul>
  <li>僵硬 (Rigidity)：难以修改，每改一处牵一髮动全身</li>
  <li>脆弱 (Fragility)：一旦修改，别的无关地方也炸到</li>
  <li>固定 (Immobility)：难以分解，让程式再重用</li>
  <li>黏滞 (Viscosity)：弹性不够，把事情做对比做错还难</li>
  <li>不需要的复杂度 (Needless Complexity)：过度设计没直接好处的基础设施</li>
  <li>不需要的重复 (Needless Repetition)：相同概念的程式码被复制贴上重复使用</li>
  <li>晦涩 (Opacity)：难以阅读，无法了解意图</li>
</ul>

<p>我们希望的好程式有以下特性：</p>

<ul>
  <li>Readability 易读，容易了解</li>
  <li>Flexibility 弹性，容易扩充</li>
  <li>Effective 效率，撰码快速</li>
  <li>Maintainability 维护性，容易找到问题</li>
  <li>Consistency 一致性，循惯例无需死背</li>
  <li>Testability 可测性，元件独立容易测试</li>
</ul>

<p>具体的说，在<em>MVC</em>的框架中，我们希望可以更细节组织程式码。</p>

<h2 id="move-code-from-controller-to-model">Move Code from Controller to Model</h2>

<p>Move finder to named_scope
Use model association
Use scope access
Add model virtual attribute
Use model callback
Replace Complex Creation with Factory Method
Move Model Logic into the Model
model.collection_model_ids
Nested Model Forms
Check the return value of “save”, otherwise use “save!”</p>

<h2 id="restful-best-practices">RESTful best practices</h2>

<p>Overuse route customizations
Needless deep nesting
Not use default route</p>

<h2 id="model-best-practices">Model best practices</h2>

<p>Keep Finders on Their Own Model
Love named_scope # same as Move finder to named_scope
the Law of Demeter
DRY: metaprogramming
Extract into Module
Extract to composed class
the Law of Demeter</p>

<h2 id="migration">Migration</h2>

<p>Isolating Seed Data
Always add DB index
Use Say with Time in Migrations</p>

<h2 id="controller-best-practices">Controller best practices</h2>

<p>Use before_filter
DRY Controller # not implement, use https://github.com/josevalim/inherited_resources</p>

<h2 id="view-best-practices">View best practices</h2>

<p>Move code into controller
Move code into model
Move code into helper
Replace instance variable with local variable
Use Form Builder # not implement, use https://github.com/justinfrench/formtastic
Organize Helper files and Remove empty helpers</p>

<h2 id="other">Other</h2>

<p>Don’t rescue Exception, rescue StandardError
Remove Trailing Whitespace</p>

<h2 id="style-guide">Style Guide</h2>

<p>http://guides.ruby.tw/ruby-rails-style-guides/</p>

<h2 id="appconcerns">app/concerns</h2>

<p>DHH 的最爱</p>

<h2 id="refactor-fat-activerecord-models">Refactor Fat ActiveRecord Models</h2>

<p>http://blog.codeclimate.com/blog/2012/10/17/7-ways-to-decompose-fat-activerecord-models/</p>

<ul>
  <li>Service Objects</li>
</ul>

<p>http://pivotallabs.com/object-oriented-rails-writing-better-controllers/</p>

<ul>
  <li>View Objects</li>
  <li>Form Objects</li>
</ul>

<h2 id="view-components">View Components</h2>

<p>https://github.com/apotonick/cells</p>

<h2 id="section-1">投影片</h2>

<ul>
  <li><a href="http://www.slideshare.net/ihower/rails-best-practices">Rails Best Practices</a></li>
</ul>

<h2 id="section-2">更多线上资源</h2>

<ul>
  <li><a href="http://rails-bestpractices.com/">Rails Best Practices Website</a></li>
  <li><a href="https://github.com/railsbp/rails_best_practices">Rails Best Practices Gem</a></li>
</ul>

        <p><a href="#">》回到页首</a></p>
	     </div>
	</div>
</div>

<div class="footer">
<div class="container">
<p>
<a href="https://ihower.tw/rails4/">Ruby on Rails 实战圣经</a> | Copyright©2014 <a href="https://ihower.tw">Wen-Tien Chang</a>. All Rights Reserved.<br>
除投影片使用<a href="http://creativecommons.org/licenses/by-nc-sa/3.0/tw/">创用 CC 授权</a>释出，文字及图片等内容保留所有权利。<br>
本网页样式来自 <a href="http://guide.couchdb.org/">CouchDB: The Definitive Guide</a>。<br>
本网页最后产生时间：04 Jan 2015
</p>
</div>
</div>
</body>
</html>
